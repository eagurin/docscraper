version: '3.8'

services:
	docscraper:
		build: .
		volumes:
			- ./docs_output:/app/docs_output
			- ./logs:/app/logs
			- ./.env:/app/.env
		environment:
			- PYTHONUNBUFFERED=1
			- BROWSER_EXECUTABLE_PATH=/usr/bin/chromium
		deploy:
			resources:
				limits:
					memory: 2G
				reservations:
					memory: 1G
		restart: unless-stopped
		healthcheck:
			test: ["CMD", "python", "-c", "import sys; sys.exit(0)"]
			interval: 30s
			timeout: 10s
			retries: 3